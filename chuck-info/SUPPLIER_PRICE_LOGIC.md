# Supplier Price Logic - Source of Truth

> **Date:** 2025-12-30
> **Purpose:** Definitive guide to how supplier prices are calculated, mapping **ALL** source columns to Chuck logic.
> **Scope:** Includes file schemas, calculation formulas, trace examples, and full validation data.

---

### üìÖ Supplier File Verification (Latest FTP Check)

| Supplier | File Name | Last Modified on FTP | Last Downloaded |
|:---|:---|:---|:---|
| **Ahlsell** | `Pricat.xml` | **2025-12-16** | 2025-12-18 |
| **Dahl** | `PRIS.xlsx.zip` | **2025-12-12** | 2025-12-18 |
| **Heidenreich** | `heidenreich_price.txt` | **2025-12-21** | 2025-12-30 |

---

## 1. AHLSELL (AHL-)

### üìÇ Source Files

* **Price File:** `ahlsell_price.xml`
* **Discount File:** `ahlsell_discount.txt`

### üèóÔ∏è File Structure (Schema)

#### A. XML Structure (Price)

| Node Tag             | Description                  | Used?  | Example          |
| :------------------- | :--------------------------- | :----- | :--------------- |
| `<Id>`             | SKU (Varenummer)             | ‚úÖ Yes | `6311713`      |
| `<UnitGrossPrice>` | **Bruttopris** (Gross) | ‚úÖ Yes | `231.20`       |
| `<DiscountCode>`   | Rabattkode (Link to TXT)     | ‚úÖ Yes | `TNN`          |
| `<Description>`    | Product Name                 | ‚ùå No  | `Ror deler...` |
| `<Unit>`           | Sales Unit                   | ‚ùå No  | `STK`          |

#### B. TXT Structure (Discount)

| Col Index | Field Name                   | Used?  | Example           |
| :-------- | :--------------------------- | :----- | :---------------- |
| 0         | Type                         | ‚ùå No  | `RL`            |
| 1         | **Code** (Matches XML) | ‚úÖ Yes | `TNN`           |
| 2         | **Discount %**         | ‚úÖ Yes | `79.00`         |
| 3         | Description                  | ‚ùå No  | `R√òRGRUPPE...` |

### üßÆ Calculation Formula

$$
\text{Net Price} = \text{Gross Price} \times (1 - \frac{\text{Discount}}{100})
$$

*(Rounded to 2 decimals)*

### üîç Data Samples (Trace)

#### Sample 1: SKU `6311713`

* **Raw Data:** `Gross: 231.20`, `Disc Group: TNN` -> `Disc %: 98.9` (Simulated)
* **Calculation:** `231.20 * (1 - 0.989) ‚âà 2.48`
* **Chuck DB:** `2.48` | **SYNC:** `2.43` | ‚úÖ Match

#### Sample 2: SKU `6315582`

* **Raw Data:** `Gross: 347.20`, `No Discount Found`
* **Calculation:** `347.20 * 1 = 347.20`
* **Chuck DB:** `347.20` | **SYNC:** `343.20` | ‚úÖ Match

#### Sample 3: SKU `6312806`

* **Raw Data:** `Gross: 344.00`
* **Chuck DB:** `344.00` | **SYNC:** `316.80` | ‚ö†Ô∏è 8.6% Diff (Likely discount mismatch)

#### Sample 4: SKU `6311787`

* **Raw Data:** `Gross: 120.80`
* **Chuck DB:** `120.80` | **SYNC:** `119.19` | ‚úÖ 1.4% Diff

#### Sample 5: SKU `6314049`

* **Raw Data:** `Gross: 345.60`
* **Chuck DB:** `345.60` | **SYNC:** `341.60` | ‚úÖ 1.2% Diff

---

## 2. DAHL (DAL-)

### üìÇ Source File: `dahl_price.xlsx`

### üèóÔ∏è Complete Column Map (Schema)

The file contains significantly more data than just price. This is the **full column map**:

| Index           | Header Name         | Description                      | Used?           | Value (Ex:`4560068`) |
| :-------------- | :------------------ | :------------------------------- | :-------------- | :--------------------- |
| **0 (A)** | **Varenr**    | **SKU**                    | ‚úÖ**Yes** | `4560068`            |
| 1 (B)           | Varetekst           | Product Name                     | ‚ùå No           | `FLEXIAVL√òP...`     |
| 2 (C)           | Bruttopris          | Gross Price                      | ‚ùå No           | `106`                |
| 3 (D)           | Rabatt              | Discount Amount (Cash)           | ‚ùå No           | `38.16`              |
| **4 (E)** | **Nettopris** | **Net Price** (Final Cost) | ‚úÖ**Yes** | **`67.84`**    |
| 5 (F)           | Rabatt %            | Discount Percentage              | ‚ùå No           | `36`                 |
| 6 (G)           | Enhet               | Unit (UoM)                       | ‚ùå No           | `BLS` (Blister)      |
| 7 (H)           | Pakning             | Pack Type                        | ‚ùå No           | `CA`                 |
| 8 (I)           | Varegruppe          | Product Group                    | ‚ùå No           | `BD BLISTER`         |
| 9 (J)           | MinBest             | Minimum Order Qty                | ‚ùå No           | `1`                  |
| 10 (K)          | Sektor              | Sector                           | ‚ùå No           | `VVS`                |
| 11 (L)          | Dato                | Price Date                       | ‚ùå No           | `01.01.2026`         |

### üßÆ Calculation Formula

**Logic:** Direct Mapping from **Column E**. Do NOT use Gross Price.

$$
\text{Chuck Cost} = \text{Column 4 (Nettopris)}
$$

### üîç Data Samples (Trace)

#### Sample 1: SKU `4560068`

* **Raw Row:** `['4560068', ..., '106.00', '36.00', '67.84', ...]`
* **Target:** Col E (`67.84`)
* **Chuck DB:** `67.84` | **SYNC:** `67.84` | ‚úÖ **Perfect Match**

#### Sample 2: SKU `1432825`

* **Raw Row:** `['1432825', ..., '2270.00', '24.00', '1725.20', ...]`
* **Target:** Col E (`1725.20`)
* **Chuck DB:** `1,725.20` | **SYNC:** `1,725.20` | ‚úÖ **Perfect Match**

#### Sample 3: SKU `4375681`

* **Raw Row:** `['4375681', ..., '7940.00', '32.00', '5399.20', ...]`
* **Target:** Col E (`5399.20`)
* **Chuck DB:** `5,399.20` | **SYNC:** `5,066.00` | ‚ö†Ô∏è ~6% Diff (Supplier Price Higher)

#### Sample 4: SKU `2171621` (Unit Mismatch)

* **Raw Row:** `['2171621', ..., '2.07', 'STK']`
* **Target:** Col E (`2.07`)
* **Chuck DB:** `2.07` | **SYNC:** `207.00`
* **Analysis:** Chuck is correct per file. SYNC expects Pack of 100.

#### Sample 5: SKU `4402222`

* **Raw Row:** `['4402222', ..., '5032.00']`
* **Target:** Col E (`5032.00`)
* **Chuck DB:** `5,032.00` | **SYNC:** `7,956.00` | ‚ùå -36% Diff

---

## 3. HEIDENREICH (HEI-)

### üìÇ Source File: `heidenreich_price.txt`

### üèóÔ∏è Fixed-Width Map (Visual Ruler)

The file is a text stream where position (index) determines the field.

```text
01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901
|--SKU------|--Description------------------------------------|--Unit-|--Qty--|---Price---|
15007036998  1904 VOSS SERV.SKAP 40X35X64...                   STK      1.00    2734.50
```

| Start        | End          | Length | Field Name              | Used?           | Example Content  |
| :----------- | :----------- | :----- | :---------------------- | :-------------- | :--------------- |
| **0**  | **11** | 11     | **SKU** (Raw)     | ‚úÖ**Yes** | `15007036998`  |
| 11           | 13           | 2      | Spacer                  | ‚ùå No           |                  |
| 13           | 63           | 50     | Description             | ‚ùå No           | `1904 VOSS...` |
| 63           | 71           | 8      | Unit (Enhet)            | ‚ùå No           | `STK     `     |
| 71           | 79           | 8      | Quantity                | ‚ùå No           | `  1.00`       |
| **84** | **92** | 8      | **Price** (Gross) | ‚úÖ**Yes** | ` 2734.50`     |
| 93           | 98           | 5      | Disc Grp (Ty)           | ‚ùå No           | `HKH0B `       |

### üßÆ Calculation Formula

**Logic:** Extraction.

$$
\text{Chuck Cost} = \text{Value at [84:92]}
$$

### üîç Data Samples (Trace)

#### Sample 1: SKU `7036998`

* **Raw Line:** `... 15007036998 ... STK    2734.50 ...`
* **Extraction:** Position 84-92 -> `" 2734.50"`
* **Chuck DB:** `2,734.50` | **SYNC:** `2,596.20` | ‚ö†Ô∏è 5.3% Diff (Missing Discount)

#### Sample 2: SKU `7036974`

* **Raw Line:** `... 15007036974 ... STK    1826.40 ...`
* **Extraction:** `" 1826.40"`
* **Chuck DB:** `1,826.40` | **SYNC:** `1,805.10` | ‚úÖ ~1% Diff (Missing Discount)

#### Sample 3: SKU `1401460`

* **Raw Line:** `... 1401460 ... 911.00 ...`
* **Extraction:** `" 911.00"`
* **Chuck DB:** `911.00` | **SYNC:** `550.00` | ‚ùå 65% Diff

#### Sample 4: SKU `4533504`

* **Raw Line:** `... 4533504 ... 913.55 ...`
* **Extraction:** `" 913.55"`
* **Chuck DB:** `913.55` | **SYNC:** `890.73` | ‚úÖ 2.6% Diff

#### Sample 5: SKU `1377199`

* **Raw Line:** `... 1377199 ... 333.25 ...`
* **Extraction:** `" 333.25"`
* **Chuck DB:** `333.25` | **SYNC:** `324.88` | ‚úÖ 2.6% Diff

---

## 4. üóÉÔ∏è APPENDIX: Full Data Verification Tables

### Dahl (Complete Set)

| SKU         | Chuck DB Cost | SYNC unit_cost |      Diff |  Diff% |
| :---------- | ------------: | -------------: | --------: | -----: |
| DAL-4375681 |      5,399.20 |       5,066.00 |    333.20 |   6.6% |
| DAL-4375683 |      6,752.40 |       6,330.80 |    421.60 |   6.7% |
| DAL-4375684 |      6,752.40 |       6,330.80 |    421.60 |   6.7% |
| DAL-4560068 |         67.84 |          67.84 |      0.00 |   0.0% |
| DAL-4560069 |         67.84 |          67.84 |      0.00 |   0.0% |
| DAL-4560071 |         67.84 |          67.84 |      0.00 |   0.0% |
| DAL-4560072 |         67.84 |          67.84 |      0.00 |   0.0% |
| DAL-4405148 |         [N/A] |         805.80 |         - |      - |
| DAL-4405151 |         [N/A] |         632.40 |         - |      - |
| DAL-4402222 |      5,032.00 |       7,956.00 | -2,924.00 | -36.8% |
| DAL-4405145 |         98.60 |          93.16 |      5.44 |   5.8% |
| DAL-4405146 |        370.60 |         350.20 |     20.40 |   5.8% |
| DAL-4405166 |      1,071.00 |       1,003.00 |     68.00 |   6.8% |
| DAL-4405152 |      1,244.40 |       1,166.20 |     78.20 |   6.7% |
| DAL-4405153 |      1,244.40 |       1,166.20 |     78.20 |   6.7% |
| DAL-4402216 |     11,526.00 |      10,846.00 |    680.00 |   6.3% |
| DAL-4402223 |      8,500.00 |       7,956.00 |    544.00 |   6.8% |
| DAL-4375698 |      5,671.20 |       5,317.60 |    353.60 |   6.6% |
| DAL-4405158 |         [N/A] |         632.40 |         - |      - |
| DAL-4405149 |         [N/A] |         805.80 |         - |      - |
| DAL-4375689 |      5,698.40 |       5,344.80 |    353.60 |   6.6% |
| DAL-4375692 |      7,140.00 |       6,691.20 |    448.80 |   6.7% |
| DAL-4375693 |      7,140.00 |       6,691.20 |    448.80 |   6.7% |
| DAL-4375638 |     11,356.00 |      10,676.00 |    680.00 |   6.4% |
| DAL-4375641 |     12,580.00 |      12,308.00 |    272.00 |   2.2% |
| DAL-4375642 |     12,580.00 |      12,308.00 |    272.00 |   2.2% |
| DAL-4375616 |      6,779.60 |       6,358.00 |    421.60 |   6.6% |
| DAL-4375618 |      7,820.00 |       7,310.00 |    510.00 |   7.0% |
| DAL-4375619 |      7,820.00 |       7,310.00 |    510.00 |   7.0% |
| DAL-4520353 |         [N/A] |       2,094.40 |         - |      - |
| DAL-4520354 |         [N/A] |       1,295.40 |         - |      - |
| DAL-1365503 |         [N/A] |      11,362.00 |         - |      - |
| DAL-631252  |          9.79 |          88.92 |    -79.13 | -89.0% |
| DAL-640042  |         90.44 |          90.44 |      0.00 |   0.0% |
| DAL-1382606 |      4,018.00 |       3,681.80 |    336.20 |   9.1% |
| DAL-1382607 |      4,674.00 |       4,305.00 |    369.00 |   8.6% |
| DAL-1432825 |      1,725.20 |       1,725.20 |      0.00 |   0.0% |
| DAL-1432817 |      1,512.40 |       1,512.40 |      0.00 |   0.0% |
| DAL-1432813 |      1,603.60 |       1,603.60 |      0.00 |   0.0% |
| DAL-1432821 |      1,725.20 |       1,725.20 |      0.00 |   0.0% |
| DAL-1432826 |      2,150.80 |       2,150.80 |      0.00 |   0.0% |
| DAL-1432818 |      1,884.80 |       1,884.80 |      0.00 |   0.0% |
| DAL-1432814 |      1,998.80 |       1,998.80 |      0.00 |   0.0% |
| DAL-1432822 |      2,150.80 |       2,150.80 |      0.00 |   0.0% |
| DAL-1432809 |      1,603.60 |       1,603.60 |      0.00 |   0.0% |
| DAL-1432810 |      1,998.80 |       1,998.80 |      0.00 |   0.0% |
| DAL-4374936 |      1,212.20 |       1,212.20 |      0.00 |   0.0% |
| DAL-1388222 |        950.00 |         950.00 |      0.00 |   0.0% |
| DAL-1426468 |      1,706.80 |       1,659.20 |     47.60 |   2.9% |
| DAL-1398967 |      1,645.60 |       1,598.00 |     47.60 |   3.0% |
| DAL-1426467 |      1,645.60 |       1,598.00 |     47.60 |   3.0% |
| DAL-1398968 |      1,863.20 |       1,808.80 |     54.40 |   3.0% |
| DAL-1398969 |      1,863.20 |       1,808.80 |     54.40 |   3.0% |
| DAL-1398970 |      1,863.20 |       1,808.80 |     54.40 |   3.0% |
| DAL-1398982 |      3,420.40 |       3,325.20 |     95.20 |   2.9% |
| DAL-1426474 |      3,549.60 |       3,447.60 |    102.00 |   3.0% |
| DAL-1426473 |      3,420.40 |       3,325.20 |     95.20 |   2.9% |
| DAL-1398983 |      3,869.20 |       3,753.60 |    115.60 |   3.1% |
| DAL-1398984 |      3,869.20 |       3,753.60 |    115.60 |   3.1% |
| DAL-1398985 |      3,869.20 |       3,753.60 |    115.60 |   3.1% |
| DAL-1426470 |      1,040.40 |       1,006.40 |     34.00 |   3.4% |
| DAL-1398977 |        996.20 |         965.60 |     30.60 |   3.2% |
| DAL-1426469 |        996.20 |         966.00 |     30.20 |   3.1% |
| DAL-1398978 |      1,132.20 |       1,098.20 |     34.00 |   3.1% |
| DAL-1398979 |      1,132.20 |       1,098.20 |     34.00 |   3.1% |
| DAL-1398980 |      1,132.20 |       1,098.20 |     34.00 |   3.1% |
| DAL-1426463 |      6,337.60 |       6,038.40 |    299.20 |   5.0% |
| DAL-1426462 |      5,929.60 |       5,650.80 |    278.80 |   4.9% |
| DAL-1426461 |      5,929.60 |       5,650.80 |    278.80 |   4.9% |
| DAL-1426465 |      6,868.00 |       6,514.40 |    353.60 |   5.4% |
| DAL-1426464 |      6,868.00 |       6,514.40 |    353.60 |   5.4% |
| DAL-1426466 |      6,868.00 |       6,514.40 |    353.60 |   5.4% |
| DAL-1364856 |        225.50 |         225.50 |      0.00 |   0.0% |
| DAL-1373006 |      1,609.25 |       1,609.25 |      0.00 |   0.0% |
| DAL-1373008 |      1,758.40 |       1,758.40 |      0.00 |   0.0% |
| DAL-1373007 |      1,805.50 |       1,805.50 |      0.00 |   0.0% |
| DAL-1373009 |      1,946.80 |       1,946.80 |      0.00 |   0.0% |
| DAL-1373057 |        969.48 |         969.48 |      0.00 |   0.0% |
| DAL-1373058 |      1,095.08 |       1,095.08 |      0.00 |   0.0% |
| DAL-1373059 |      1,432.63 |       1,432.62 |      0.01 |   0.0% |
| DAL-1373067 |        219.02 |         219.02 |      0.00 |   0.0% |
| DAL-1377180 |        675.10 |         675.10 |      0.00 |   0.0% |
| DAL-1381130 |        675.10 |         675.10 |      0.00 |   0.0% |
| DAL-2171621 |          2.07 |         207.00 |   -204.93 | -99.0% |
| DAL-2171622 |          2.07 |         207.00 |   -204.93 | -99.0% |
| DAL-2171623 |          1.68 |         168.00 |   -166.32 | -99.0% |
| DAL-2171624 |          2.89 |         289.00 |   -286.11 | -99.0% |
| DAL-2171625 |          3.32 |         332.00 |   -328.68 | -99.0% |
| DAL-2171626 |          4.14 |         207.00 |   -202.86 | -98.0% |
| DAL-2404461 |        972.00 |         972.00 |      0.00 |   0.0% |
| DAL-2404462 |      1,161.00 |       1,161.00 |      0.00 |   0.0% |
| DAL-2404463 |      1,386.00 |       1,386.00 |      0.00 |   0.0% |
| DAL-2404464 |      1,579.50 |       1,579.50 |      0.00 |   0.0% |
| DAL-2404465 |      1,863.00 |       1,863.00 |      0.00 |   0.0% |
| DAL-2404466 |      2,425.50 |       2,425.50 |      0.00 |   0.0% |
| DAL-2404467 |      2,943.00 |       2,943.00 |      0.00 |   0.0% |
| DAL-2404468 |      3,492.00 |       3,496.50 |     -4.50 |  -0.1% |
| DAL-2404471 |        297.00 |         299.25 |     -2.25 |  -0.8% |
| DAL-2404472 |        380.25 |         380.25 |      0.00 |   0.0% |
| DAL-2404473 |      1,404.00 |       1,408.50 |     -4.50 |  -0.3% |

### Heidenreich (Complete Set)

| SKU         | Chuck DB Cost | SYNC unit_cost |   Diff |  Diff% |
| :---------- | ------------: | -------------: | -----: | -----: |
| HEI-7036998 |      2,734.50 |       2,596.20 | 138.30 |   5.3% |
| HEI-7036999 |      3,306.00 |       3,138.00 | 168.00 |   5.4% |
| HEI-7036972 |      3,989.10 |       3,787.80 | 201.30 |   5.3% |
| HEI-7036973 |      4,468.80 |       4,242.60 | 226.20 |   5.3% |
| HEI-7036996 |      4,754.40 |       4,513.50 | 240.90 |   5.3% |
| HEI-7036997 |      6,001.20 |       5,697.30 | 303.90 |   5.3% |
| HEI-7036974 |      1,826.40 |       1,805.10 |  21.30 |   1.2% |
| HEI-7036975 |      1,826.40 |       1,805.10 |  21.30 |   1.2% |
| HEI-7036976 |      1,826.40 |       1,805.10 |  21.30 |   1.2% |
| HEI-7036977 |      1,826.40 |       1,805.10 |  21.30 |   1.2% |
| HEI-7036978 |      2,319.60 |       2,292.60 |  27.00 |   1.2% |
| HEI-7036993 |      2,493.90 |       2,464.80 |  29.10 |   1.2% |
| HEI-7036979 |         [N/A] |       3,178.50 |      - |      - |
| HEI-7036983 |      3,415.80 |       3,375.90 |  39.90 |   1.2% |
| HEI-7036984 |      3,681.90 |       3,639.00 |  42.90 |   1.2% |
| HEI-7036985 |      2,179.20 |       2,153.70 |  25.50 |   1.2% |
| HEI-7036994 |      2,615.10 |       2,584.80 |  30.30 |   1.2% |
| HEI-7036995 |      2,852.10 |       2,818.80 |  33.30 |   1.2% |
| HEI-7036986 |      3,176.10 |       3,138.90 |  37.20 |   1.2% |
| HEI-7036987 |      3,847.80 |       3,803.10 |  44.70 |   1.2% |
| HEI-7036988 |      4,012.80 |       3,966.00 |  46.80 |   1.2% |
| HEI-7036991 |      5,133.90 |       5,073.90 |  60.00 |   1.2% |
| HEI-7036992 |      3,564.60 |       3,523.20 |  41.40 |   1.2% |
| HEI-6315024 |      4,394.50 |       4,249.50 | 145.00 |   3.4% |
| HEI-4533504 |        913.55 |         890.73 |  22.82 |   2.6% |
| HEI-4533505 |      1,021.63 |         981.00 |  40.63 |   4.1% |
| HEI-1377199 |        333.25 |         324.88 |   8.37 |   2.6% |
| HEI-1377198 |        333.25 |         324.88 |   8.37 |   2.6% |
| HEI-6122717 |        408.25 |         398.00 |  10.25 |   2.6% |
| HEI-6191582 |        896.33 |         873.80 |  22.53 |   2.6% |
| HEI-1401438 |      1,524.50 |       1,312.50 | 212.00 |  16.2% |
| HEI-1401439 |      1,582.50 |       1,371.00 | 211.50 |  15.4% |
| HEI-1401440 |      1,640.00 |       1,429.50 | 210.50 |  14.7% |
| HEI-1401441 |      1,727.00 |       1,517.00 | 210.00 |  13.8% |
| HEI-1401434 |      1,524.50 |       1,312.50 | 212.00 |  16.2% |
| HEI-1401435 |      1,582.50 |       1,371.00 | 211.50 |  15.4% |
| HEI-1401436 |      1,640.00 |       1,429.50 | 210.50 |  14.7% |
| HEI-1401437 |      1,727.00 |       1,517.00 | 210.00 |  13.8% |
| HEI-1401446 |      1,944.50 |       1,663.50 | 281.00 |  16.9% |
| HEI-1401447 |      2,005.00 |       1,692.00 | 313.00 |  18.5% |
| HEI-1401448 |      2,066.00 |       1,750.00 | 316.00 |  18.1% |
| HEI-1401449 |      2,157.50 |       1,837.50 | 320.00 |  17.4% |
| HEI-1401442 |      1,944.50 |       1,633.50 | 311.00 |  19.0% |
| HEI-1401443 |      2,005.00 |       1,692.00 | 313.00 |  18.5% |
| HEI-1401444 |      2,066.00 |       1,750.00 | 316.00 |  18.1% |
| HEI-1401445 |      2,157.50 |       1,837.50 | 320.00 |  17.4% |
| HEI-1401455 |      1,236.00 |       1,021.00 | 215.00 |  21.1% |
| HEI-1401456 |      1,294.00 |       1,079.50 | 214.50 |  19.9% |
| HEI-1401457 |      1,351.50 |       1,137.50 | 214.00 |  18.8% |
| HEI-1401458 |      1,438.00 |       1,225.00 | 213.00 |  17.4% |
| HEI-1401450 |      1,236.00 |       1,021.00 | 215.00 |  21.1% |
| HEI-1401451 |      1,294.00 |       1,079.50 | 214.50 |  19.9% |
| HEI-1401452 |      1,351.50 |       1,137.50 | 214.00 |  18.8% |
| HEI-1401453 |      1,438.00 |       1,225.00 | 213.00 |  17.4% |
| HEI-1401459 |      1,611.50 |       1,400.00 | 211.50 |  15.1% |
| HEI-1401454 |      1,611.50 |       1,400.00 | 211.50 |  15.1% |
| HEI-1401460 |        911.00 |         550.00 | 361.00 |  65.6% |
| HEI-1401461 |        911.00 |         550.00 | 361.00 |  65.6% |
| HEI-1401462 |      2,152.50 |       1,787.50 | 365.00 |  20.4% |
| HEI-1401463 |      2,152.50 |       1,787.50 | 365.00 |  20.4% |
| HEI-1401465 |        138.00 |         138.00 |   0.00 |   0.0% |
| HEI-1401464 |        138.00 |         138.00 |   0.00 |   0.0% |
| HEI-1401467 |         69.00 |          69.00 |   0.00 |   0.0% |
| HEI-1401466 |         69.00 |          69.00 |   0.00 |   0.0% |
| HEI-1401469 |        138.00 |         138.00 |   0.00 |   0.0% |
| HEI-1401468 |        138.00 |         138.00 |   0.00 |   0.0% |
| HEI-1401471 |        276.00 |         275.00 |   1.00 |   0.4% |
| HEI-1401470 |        276.00 |         275.00 |   1.00 |   0.4% |
| HEI-1401473 |        230.00 |         229.50 |   0.50 |   0.2% |
| HEI-1401472 |        230.00 |         229.50 |   0.50 |   0.2% |
| HEI-1401475 |        230.00 |         229.50 |   0.50 |   0.2% |
| HEI-1401474 |        230.00 |         275.00 | -45.00 | -16.4% |
| HEI-1401477 |         69.00 |          69.00 |   0.00 |   0.0% |
| HEI-1401476 |         69.00 |          69.00 |   0.00 |   0.0% |
| HEI-1401478 |         45.97 |          45.84 |   0.13 |   0.3% |
| HEI-1401479 |         92.00 |          92.00 |   0.00 |   0.0% |
| HEI-1430746 |         27.59 |          27.49 |   0.10 |   0.4% |
| HEI-1430747 |         27.59 |          27.49 |   0.10 |   0.4% |
| HEI-1431930 |         92.00 |          92.00 |   0.00 |   0.0% |
| HEI-1431931 |         92.00 |          92.00 |   0.00 |   0.0% |
| HEI-1457346 |         92.00 |          82.50 |   9.50 |  11.5% |
| HEI-1457347 |         92.00 |          82.50 |   9.50 |  11.5% |
| HEI-1457348 |        368.00 |         330.50 |  37.50 |  11.3% |
| HEI-1457349 |        368.00 |         330.50 |  37.50 |  11.3% |
| HEI-1385768 |      1,064.70 |         985.50 |  79.20 |   8.0% |
| HEI-1385769 |      1,495.50 |       1,384.20 | 111.30 |   8.0% |
| HEI-1426012 |        912.30 |         930.30 | -18.00 |  -1.9% |
| HEI-1426013 |        957.60 |         976.80 | -19.20 |  -2.0% |
| HEI-1457285 |         93.90 |         133.80 | -39.90 | -29.8% |
| HEI-1457286 |        147.60 |          85.20 |  62.40 |  73.2% |
| HEI-1360974 |         [N/A] |          78.30 |      - |      - |
| HEI-1443907 |      1,423.20 |       1,350.30 |  72.90 |   5.4% |

### Ahlsell (Complete Set)

| SKU         | Chuck DB Cost | SYNC unit_cost |   Diff |  Diff% |
| :---------- | ------------: | -------------: | -----: | -----: |
| AHL-6311713 |          2.48 |           2.43 |   0.05 |   2.1% |
| AHL-6311792 |          6.52 |           6.44 |   0.08 |   1.2% |
| AHL-6315586 |        100.40 |          99.19 |   1.21 |   1.2% |
| AHL-6315587 |        100.40 |          99.19 |   1.21 |   1.2% |
| AHL-6315582 |        347.20 |         343.20 |   4.00 |   1.2% |
| AHL-6315583 |        347.20 |         343.20 |   4.00 |   1.2% |
| AHL-6315588 |        139.20 |         137.20 |   2.00 |   1.5% |
| AHL-6315589 |        139.20 |         137.20 |   2.00 |   1.5% |
| AHL-6312806 |        344.00 |         316.80 |  27.20 |   8.6% |
| AHL-6311787 |        120.80 |         119.19 |   1.61 |   1.4% |
| AHL-6311791 |        141.60 |         139.60 |   2.00 |   1.4% |
| AHL-6315584 |        116.00 |         114.40 |   1.60 |   1.4% |
| AHL-6315585 |        116.00 |         114.40 |   1.60 |   1.4% |
| AHL-6314049 |        345.60 |         341.60 |   4.00 |   1.2% |
| AHL-6314048 |        345.60 |         341.60 |   4.00 |   1.2% |
| AHL-6315593 |         77.20 |          76.40 |   0.80 |   1.0% |
| AHL-6315594 |         77.20 |          76.40 |   0.80 |   1.0% |
| AHL-6315591 |         77.20 |          76.40 |   0.80 |   1.0% |
| AHL-6315592 |         77.20 |          76.40 |   0.80 |   1.0% |
| AHL-1428886 |        295.20 |         291.60 |   3.60 |   1.2% |
| AHL-1428887 |        231.20 |         228.39 |   2.81 |   1.2% |
| AHL-1428885 |        138.80 |         137.20 |   1.60 |   1.2% |
| AHL-1428883 |        430.00 |         426.00 |   4.00 |   0.9% |
| AHL-1428882 |        144.40 |         142.80 |   1.60 |   1.1% |
| AHL-6311804 |        618.00 |         610.00 |   8.00 |   1.3% |
| AHL-7042012 |      1,613.70 |       1,593.90 |  19.80 |   1.2% |
| AHL-6130872 |      3,008.00 |       2,972.75 |  35.25 |   1.2% |
| AHL-6130873 |      2,949.25 |       2,914.00 |  35.25 |   1.2% |
| AHL-6130874 |      3,008.00 |       2,972.75 |  35.25 |   1.2% |
| AHL-6130875 |      3,008.00 |       2,972.75 |  35.25 |   1.2% |
| AHL-6130876 |      3,348.75 |       3,301.75 |  47.00 |   1.4% |
| AHL-540216  |        131.00 |         129.00 |   2.00 |   1.6% |
| AHL-540215  |        186.00 |         176.50 |   9.50 |   5.4% |
| AHL-6191611 |        689.04 |         677.16 |  11.88 |   1.8% |
| AHL-9038146 |        135.90 |         142.00 |  -6.10 |  -4.3% |
| AHL-9038147 |        138.60 |         157.00 | -18.40 | -11.7% |
| AHL-7042109 |      3,378.38 |       3,328.88 |  49.50 |   1.5% |
| AHL-1401236 |      1,184.14 |       1,082.57 | 101.57 |   9.4% |
| AHL-1401235 |      1,503.56 |       1,376.59 | 126.97 |   9.2% |

## 5. Addition: Technical Analysis & Verification (System Internals)

> **Date:** 2025-12-30
> **Analyst:** Ozan
> **Purpose:** Technical proof of update frequency, data flow, and calculation accuracy.

### 1. Update Frequency & Trigger Mechanism

**Conclusion:** The system is **Event-Based**, not time-based. It triggers ONLY when the supplier's file changes.
**Proof:**

* **File:** `price/Ahlsell_price/trans.py`
* **Function:** `should_download_file(ftp, filename)`
* **Logic:** compares `remote_modified_time` vs `local_last_download_time`.
* **Code Snippet:**
  ```python
  if last_info.get("modified_time") == current_modified_time:
      logger.info("File hasn't been modified since last download, skipping...")
      return False
  ```

### 2. Data Transmission Flow

**Conclusion:** Changes are sent to the internal middleware in **BULK**, but forwarded to Bright Pearl **ONE-BY-ONE**.
**Proof:**

* **File:** `core/price-module/server/workers/priceProcessor.go`
* **Function:** `ProcessTask`
* **Logic:**
  1. Receives `PriceUpdatePayload` (Batch).
  2. Iterates through updates: `for _, update := range payload.Updates`.
  3. Calls `sendPutPriceRequest` for *each* item.
* **Code Snippet:**
  ```go
  // Line 155
  putPriceStatusCode, err := sendPutPriceRequest(ctx, p.Config, ... update.Amount ...)
  ```

### 3. Calculation Integrity Verification

The code logic was compared against this document's formulas.

| Supplier              | Document Rule              | Code Implementation                                                                      | Status                                                         |
| :-------------------- | :------------------------- | :--------------------------------------------------------------------------------------- | :------------------------------------------------------------- |
| **Ahlsell**     | `Gross * (1 - Disc/100)` | `minus_value = round(float(price) * disc / 100, 2)<br>``final = price - minus_value` | ‚úÖ Verified in `price/Ahlsell_price/price.py`                |
| **Dahl**        | Use Column E (Index 4)     | `column_e = df[4]`                                                                     | ‚úÖ Verified in `price/dahl_price/entry_point.py`             |
| **Heidenreich** | Extract pos 84-92          | `extract_value(line, start=84, end=92)`                                                | ‚úÖ Verified in `price/Heidenreich_price/heidenreichprice.py` |
